# 采样板构成

## 1 下位机

### 1.1 硬件部分

- OUT
    - PA12, LED灯
  
- ADC
  - ADC1
    
    - PB0, 电流采样
    
    - PB1, 电压采样
  
- TIM
  - TIM2, APB1, 10kHz
  - TIM5, APB1, 1000Hz

- SPI

  - SPI1
    - PA4, CS
    - PA5, CLK
    - PA6, MISO
    - PA7, MOSI

- USART
  - USART1, 1Mbps, 8n1
    - PB6, Tx
    - PB7, Rx

## 1.2 协议

| 字段 | Frame_Header   | Current        | Voltage        | Power        | Checksum                                                 |
| ---- | :------------- | :------------- | :------------- | :----------- | :------------------------------------------------------- |
| 长度 | 1B             | 4B             | 4B             | 4B           | 1B                                                       |
| 说明 | 帧头，默认0xAB | 电流值，浮点数 | 电压值，浮点数 | 功率，浮点数 | 校验和，范围是前面的三个浮点数字段按字节求和，不考虑溢出 |



## 2 上位机

- 制作中，打算可以实现下述功能
  - 用裁判系统或者电子负载标定电流电压功率等参数，并写到背板flash里
  - 配置相关滤波器系数，写道背板flash里
  - 配置反馈频率，或实现请求回复功能